
<!DOCTYPE html>
<html lang="en">
	
<!-- Mirrored from 56k.studiovoila.com/deploying-static-sites-with-github-actions-and-netlify by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 11 May 2020 16:46:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
		<meta charset="utf-8" />
		<title>56k</title>
		<link rel="canonical" href="#">
		<meta name="description" content="">
		<meta http-equiv="Content-Type" content="text/html" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="format-detection" content="telephone=no">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=5">
		<meta name="description" content="">
		<link rel="apple-touch-icon" sizes="120x120" href="apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
		<link rel="manifest" href="site.html">
		<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
		<meta name="msapplication-TileColor" content="#da532c">
		<meta name="theme-color" content="#ffffff">
		<link rel="stylesheet" type="text/css" href="dist/app.b5a119cab45c03c29cba.css">
	</head>

	<body>
		
		<header class="c-site-head | js-site-head js-smooth-section">
  <div class="c-site-head__inner o-row o-row--expanded">
    <div class="c-site-head__left">
      <a href="index.html" class="c-site-head__logo js-site-link">
        <img src="static/logo.svg" alt="56k">
      </a>
    </div>
    <nav class="c-site-head__right">
      <ul class="c-site-head__menu">
        <li>
          <a href="training.html" class="js-site-link ">Training</a>
        </li>
        <li>
          <a href="about.html" class="js-site-link ">About</a>
        </li>
        <li>
          <a href="blog.html" class="js-site-link ">Blog</a>
        </li>
      </ul>
      <button type="button" class="c-site-head__contact | js-open-cmodal">
        <span class="c-btn | js-outer-btn">
          <div class="c-btn__inner">

            <span class="c-btn__title">
              <span class="c-btn__item c-btn__item--first">Contact us</span>
              <span class="c-btn__item c-btn__item--last" aria-hidden="true">Contact us</span>
            </span>

            <span class="c-btn__icon">
              <svg version="1.1" id="Lager_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
              viewBox="0 0 32.8 32.8" style="enable-background:new 0 0 32.8 32.8;" xml:space="preserve">
              <style type="text/css">
              .st0{fill-rule:evenodd;clip-rule:evenodd;fill:#101A56;}
              </style>
              <path class="st0" d="M32.2,8.8l-1.4,1.4c-0.8,0.8-2,0.8-2.7,0l-5.5-5.5c-0.8-0.8-0.8-2,0-2.7L24,0.6c0.8-0.8,2-0.8,2.7,0L32.2,6
              C33,6.8,33,8,32.2,8.8z M25.4,15.6L8.2,32.8l-8.2,0v-8.2L17.2,7.4c0.8-0.8,2-0.8,2.7,0l5.5,5.5C26.1,13.6,26.1,14.8,25.4,15.6z"/>
              </svg>
            </span>

            <span class="c-btn__svg">
              <svg width="10" height="10" viewBox="0 0 10 10" preserveAspectRatio="none">
                <path class="js-path" d="M 10,10 L 10,10 C 10,10 10,10 5,10 C 0,10 0,10 0,10 L 0,10 Z"></path>
              </svg>
            </span>
            
          </div>
        </span>
      </button>

      <button class="c-site-head__toggle | js-site-head__toggle">
        <span class="c-btn">
          <div class="c-btn__inner">
            <span>Menu</span>
            <span class="c-btn__icon">
              <!-- Generator: Adobe Illustrator 23.0.6, SVG Export Plug-In  -->
              <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="34px"
              height="25px" viewBox="0 0 34 25" style="enable-background:new 0 0 34 25;" xml:space="preserve">
              <style type="text/css">
              .st0{fill-rule:evenodd;clip-rule:evenodd;fill:#16215C;}
              </style>
              <defs>
              </defs>
              <path id="Rounded_Rectangle_2_1_" class="st0" d="M2.5,0h29C32.88,0,34,1.12,34,2.5S32.88,5,31.5,5h-29C1.12,5,0,3.88,0,2.5
              S1.12,0,2.5,0z M2.5,10h29c1.38,0,2.5,1.12,2.5,2.5S32.88,15,31.5,15h-29C1.12,15,0,13.88,0,12.5S1.12,10,2.5,10z M2.5,20h29
              c1.38,0,2.5,1.12,2.5,2.5S32.88,25,31.5,25h-29C1.12,25,0,23.88,0,22.5S1.12,20,2.5,20z"/>
              </svg>
            </span>
          </div>
        </span>
      </button>
    </nav>
  </div>
  <div class="c-site-head__label">
    <div class="o-row o-row--medium">
      <p>The cloud computing platform</p>
    </div>
  </div>  
</header>

<aside class="c-site-nav | js-site-nav">
  <div class="c-site-nav__inner | js-site-nav__inner">
    <button class="c-site-nav__close | js-site-nav__close">
      <img src="static/icons/plus-white.svg">
    </button>
    <a href="index.html" class="c-site-nav__logo js-site-link">
      <img src="static/logo.png" alt="56k">
    </a>
    <ul>
      <li>
        <a href="index.html" class="c-site-nav__link | js-site-nav__link ">Home</a>
      </li>
      <li>
        <a href="training.html" class="c-site-nav__link | js-site-nav__link ">Training</a>
      </li>
      <li>
        <a href="about.html" class="c-site-nav__link | js-site-nav__link ">About</a>
      </li>
      <li>
        <a href="https://blog.56k.cloud/" class="c-site-nav__link | js-site-nav__link">Blog</a>
      </li>
    </ul>
    <button class="c-site-nav__contact | js-site-nav__contact js-open-cmodal">
      <span>Contact</span>
      <span><svg version="1.1" id="Lager_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 32.8 32.8" style="enable-background:new 0 0 32.8 32.8;" xml:space="preserve">
      <style type="text/css">
      .st0{fill-rule:evenodd;clip-rule:evenodd;fill:#101A56;}
      </style>
      <path class="st0" d="M32.2,8.8l-1.4,1.4c-0.8,0.8-2,0.8-2.7,0l-5.5-5.5c-0.8-0.8-0.8-2,0-2.7L24,0.6c0.8-0.8,2-0.8,2.7,0L32.2,6
      C33,6.8,33,8,32.2,8.8z M25.4,15.6L8.2,32.8l-8.2,0v-8.2L17.2,7.4c0.8-0.8,2-0.8,2.7,0l5.5,5.5C26.1,13.6,26.1,14.8,25.4,15.6z"></path>
      </svg></span>
    </button>
  </div>
</aside>
		<main class="o-main | js-smooth" data-router-wrapper>
	<section class="o-page" data-router-view="blog">
		<div class="c-single | js-smooth-section">

			<div class="o-gutter">
				<div class="o-row o-row--smaller">
					<div class="c-single__inner">
						<div class="c-single__headline">
							<h1 class="c-single__title o-h2 | js-t-lines">Deploying static sites with GitHub Actions and Netlify</h1>

							<div class="c-single__headline-author">
								<figure class="c-single__headline-img">
									<img src="static/about/dan.jpg">
								</figure>
								<p class="c-single__headline-name">Dan Achim</p>
								<p class="c-single__headline-date">February 2020</p>
							</div>
						</div>

						
						<div class="c-single__content u-color-text">

							<p>...and a hack to turn that PHP site into a static on</p>

							<h2>Background</h2>

							<p>For the last few months, we have been in a rebranding process here at 56k.cloud, that included a brand-new website developed by the awesome team at <a href="http://twotwentytwo.se/" target="_blank">Twotwentytwo</a>. The finished product that we have received from them was a site developed in Php with some Node.js built assets. But internally we decided that we really want a static site and to keep using <a href="https://www.netlify.com/" target="_blank">Netlify</a> as everyone has been very happy with it</p>

							<p>The solution</p>

							<p>Because the website’s code was already hosted on GitHub, GitHub’s new <a href="https://github.com/features/actions" target="_blank">Actions feature</a> seemed like the best fit for our CI / CD needs: it supports all types of steps that are required and it is already baked into GitHub, we just needed to enable the feature.</p>

							<h2>The steps</h2>

							<p>After enabling actions on the website’s GitHub repo, we could get to work at defining our workflow, in GitHub’s lingo. What other solutions would call a pipeline. The first step was to create a <code>.github/workflows/main.yml</code> that would hold this deploy-to-Netlify workflow.</p>

							<ul>
								<li>The workflow .yml needs to have a starting header that will define things like its name, what environment to run on (`ubuntu-latest`) or on which actions it should trigger. A decision has been made to trigger this only on pushes to the <code>master</code> branch:

								<pre>
on:
  push:
    branches:
	- master

jobs:
  build-deploy:
    name: Build and deploy the 56k.cloud website
	runs-on: ubuntu-latest

	steps:
								</pre>
								</li>

								<li>Now we can start the workflow by checking out the Git repository and installing the tools that we need, in this case Php and Node.js:
								<div></div>
								<pre>
steps:
  - name: Checkout
    uses: actions/checkout@v1
  - name: Setup Node
    uses: actions/setup-node@v1
    with:

    node-version: '11.x'

  - name: Setup PHP

    uses: shivammathur/setup-php@v1
    with:
      php-version: '7.4'
</pre>
								</li>
								<li>The next step is to install the NPM modules required to generate the static assets and actually generate them
<pre>
  - name: Install the site dependencies
	run: npm install
  - name: Build the site static assets
	run: npm run build
</pre>

								</li>

								<li>Here comes the <code>hackish</code> part where we turn this site into a static one. This is achieved by running a Php development web server *in* the pipeline, in the background that serves the Php code plus the static assets generated the previous step. Then we use the classic and always useful <code>wget</code> to crawl this website and save locally the HTML content
<pre>
  - name: Start the PHP dev server in the background
	run: nohup php -S 0.0.0.0:8080 > /dev/null 2>&1 &
  - name: Crawl the website to get our nice HTML files
	run: mkdir output && cd output && wget -k -K -E -r -p -N -F -nH -q
	http://localhost:8080/
</pre>

								</li>

								<li>Now we need to copy the previously built static assets in the <code>output</code> directory and do a bit of cleanup because <code>wget</code> will save some of those HTML files with links containing <code>http://localhost:8080/</code>. We want to remove that reference to localhost and leave all the links relative, so the HTML files can be hosted anywhere:
<pre>
  - name: Copy the right static files
    run: |
	  cp -r ./dist/* ./output/dist/
	  cp -r ./static/* ./output/static/
  - name: Find all artifacts from Wget and clean them up
	  run: cd output && find ./ -type f -exec sed -i 's/http\:\/\/localhost\:8080//g' {} \;
</pre>
								</li>

								<li>At this point in the workflow we have an <code>output</code> directory that contains a static, cleaned up, website. We just need to deploy it to Netlify! This step can be easily achieved using by using <a href="https://docs.netlify.com/cli/get-started/#manual-deploys" target="_blank">Netlify’s CLI</a>. Before defining this step, you need to make sure you have defined a new site in Netlify’s Web UI from where you can get your site ID that you need here and you have generated an Auth token for your user (the steps can be found in Netlify’s CLI documentation).
<pre>
  - name: Install the Netlify CLI
    run: npm install netlify-cli -g
  - name: Deploy the website
    run: netlify deploy --prod --dir ./output/ --site=<site_id> --auth=<auth_token> --timeout=600 --message "Deployed on $(date)"
</pre>

								</li>
							</ul>
<p>That’s it! Save the workflow file .yml file, push and commit it to GitHub and it should trigger a GitHub action that will do all the work for you from now on and regenerate and redeploy the website at every commit to the <code>master</code> branch. You are reading this blog post as a result of this process :)</p>


						</div>

						<a href="blog.html" class="o-button">← Back to blog</a>
					</div>
				</div>
			</div>
		</div>

		<div class="js-smooth-section">
			<div class="c-site-foot o-gutter">
  <div class="c-site-foot__inner o-row u-bg-white">
	<div class="c-site-foot__content">
	  <h3 class="c-site-foot__title o-h4">
		56K.Cloud GmbH is a Technology company focusing on Automation, Cloud, Containers, and DevOps
	  </h3>
	  <a href="index.html" class="c-site-foot__logo">
		<img src="static/logo.png" alt="56k">
	  </a>
	  <div class="c-site-foot__info">
		<ul class="c-site-foot__menu">
		  <li>
			<a href="training.html" class="js-site-link ">Training</a>
		  </li>
		  <li>
			<a href="about.html" class="js-site-link ">About</a>
		  </li>
		  <li>
			<a href="blog.html" class="js-site-link ">Blog</a>
		  </li>
		  <li>
			<a href="#0" class="js-open-cmodal" data-router-disabled>Contact us</a>
		  </li>
		</ul>
		<p class="c-site-foot__address u-color-text">
		  56K.Cloud GmbH<br>
		  Bleicherweg 10,<br>
		  8002 Zürich<br>
		  Switzerland
		</p>
	  </div>
	  <hr class="c-site-foot__line">
	  <div class="c-site-foot__bottom">
	  	<div class="c-site-foot__social">
			<ul>
			  <li>
			  	<a href="https://twitter.com/56kcloud">
			  		<img src="static/footer/twitter.svg">
			  	</a>
			  </li>
			  <li>
			  	<a href="https://www.linkedin.com/company/56kcloud">
			  		<img src="static/footer/In.svg">
			  	</a>
			  </li>
			</ul>
		</div>
		<p class="c-site-foot__copyright u-color-text">Copyright (c) 2020, 56K.Cloud GmbH;
all rights reserved</p>
	  </div>
		<p class="c-site-foot__short">
			<span class="c-site-foot__by">
				<span class="c-site-foot__short-text u-color-text">Design by</span>
				<a class="c-site-foot__short-img" href="https://studiovoila.com/" target="_blank" rel="noreferrer"><img src="static/footer/voila.png" alt="Voila"></a>
			</span>
		</p>
	</div>
  </div>
</div>
		</div>

	</section>

		</main>

		<aside class="c-cmodal | js-cmodal">
			<div class="c-cmodal__inner | js-cmodal__inner">
				<figure class="c-cmodal__img">
					<button type="button" class="c-cmodal__close | js-close-cmodal">
						<img src="static/icons/plus-white.svg" alt="close">
					</button>
					<img src="static/modal-img.png" alt="">
				</figure>
				<div class="c-cmodal__content">
					<h1 class="c-cmodal__title o-title u-txt-center">Let's talk</h1>
					<p class="c-cmodal__sub-title u-txt-center"">Find out how 56k Cloud can benefit you!</p>

					<form id="contact-form" class="c-cform">
						<input type="text" class="c-cform__input" placeholder="Your name">
						<input type="email" class="c-cform__input" placeholder="Your email">
						<textarea class="c-cform__textarea">Your Message...</textarea>
			
				        <button type="submit" class="c-cform__submit">
				          <span class="c-btn | js-outer-btn">
				            <div class="c-btn__inner">

				              <span class="c-btn__title c-cform__submit-inner">
				                <span class="c-btn__item c-btn__item--first">Let's Talk</span>
				                <span class="c-btn__item c-btn__item--last">Let's Talk</span>
				              </span>

				              <span class="c-btn__svg">
				                <svg width="10" height="10" viewBox="0 0 10 10" preserveAspectRatio="none">
				                  <path class="js-path" d="M 10,10 L 10,10 C 10,10 10,10 5,10 C 0,10 0,10 0,10 L 0,10 Z"></path>
				                </svg>
				              </span>
				              
				            </div>
				          </span>
				        </button>
					</form>

				</div>
			</div>
		</aside>

		<div class="c-pe | js-pe"></div>

		<svg xmlns="http://www.w3.org/2000/svg" style="position:absolute; width: 0; height: 0"></svg>		<script src="dist/vendor.74cdbf50015cc8e0d5c8.js"></script>
		<script src="dist/app.e7ea521ec6a50ce9914c.js"></script>
	</body>

<!-- Mirrored from 56k.studiovoila.com/deploying-static-sites-with-github-actions-and-netlify by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 11 May 2020 16:46:35 GMT -->
</html>